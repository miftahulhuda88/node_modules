"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[4263],{19150:function(I,l,e){e.d(l,{R:function(){return o}});var t=e(19565),a=e(20108);function o(i={},m={}){const{id:n="",...s}=i,{get:c}=(0,t.kY)(),{data:r,isError:d,isLoading:u,refetch:p}=(0,a.useQuery)(["users",n,s],async()=>{const{data:{data:D}}=await c(`/admin/users/${n}`,{params:s});return D},m);let M=[];return n&&r?M=[r]:Array.isArray(r?.results)&&(M=r.results),{users:M,pagination:r?.pagination??null,isLoading:u,isError:d,refetch:p}}},40874:function(I,l,e){e.r(l),e.d(l,{default:function(){return oe}});var t=e(32735),a=e(19565),o=e(15062),i=e(53038),m=e(78125),n=e(20011),s=e(27649),c=e(82055),r=e(41415),d=e(17e3),u=e(72850),p=e(87933),M=e(49372),D=e(15335),O=e(5803),U=e(66456),A=e(29439),j=e(92802),N=e(33795),x=e.n(N),Y=e(9086),C=e.n(Y),F=e(88423),z=e.n(F),H=e(60216),b=e.n(H),V=e(67879),v=e(19150),G=e(8997),ee=e(4397),te=e(1057);const ae=async(T,h)=>{const{put:E}=(0,a.tg)(),{data:P}=await E(`/admin/users/${T}`,h);return P.data};var se=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]];const ne=(()=>window&&window.strapi&&window.strapi.isEE?e(28890).Z:e(16325).Z)(),X=["email","firstname","lastname","username","isActive","roles"],J=T=>{let{canUpdate:h}=T;const{formatMessage:E}=(0,V.Z)(),{params:{id:P}}=(0,i.$B)("/settings/users/:id"),{push:W}=(0,i.k6)(),{setUserDisplayName:R}=(0,a.L7)(),B=(0,a.lm)(),{lockApp:Q,unlockApp:ie}=(0,a.o1)();(0,a.go)();const{users:[K],isLoading:k}=(0,v.R)({id:P},{onError(g){const{status:f}=g.response;f===403?(B({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),W("/")):B({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),le=async(g,f)=>{Q();try{const y=await ae(P,C()(g,"confirmPassword"));B({type:"success",message:E({id:"notification.success.saved",defaultMessage:"Saved"})});const L=a.I8.getUserInfo();if(P.toString()===L.id.toString()){a.I8.setUserInfo(y);const Z=x()(g,"username")||(0,G.Pp)(g.firstname,g.lastname);R(Z)}f.setValues(z()(g,X))}catch(y){const L=(0,G.Iz)(y.response.data),Z=Object.keys(L).reduce(($,w)=>($[w]=L[w].id,$),{});f.setErrors(Z),B({type:"warning",message:x()(y,"response.data.error.message","notification.error")})}ie()},de=k?{id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}:{id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},_=Object.keys(z()(K,X)).reduce((g,f)=>f==="roles"?(g[f]=(K?.roles||[]).map(y=>{let{id:L}=y;return L}),g):(g[f]=K?.[f],g),{}),ce=_.username||(0,G.Pp)(_.firstname,_.lastname),q=E(de,{name:ce});return k?t.createElement(s.o,{"aria-busy":"true"},t.createElement(a.SL,{name:"Users"}),t.createElement(c.T,{primaryAction:t.createElement(r.z,{disabled:!0,startIcon:t.createElement(U.Z,null),type:"button",size:"L"},E({id:"global.save",defaultMessage:"Save"})),title:q,navigationAction:t.createElement(a.rU,{startIcon:t.createElement(A.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},E({id:"global.back",defaultMessage:"Back"}))}),t.createElement(d.D,null,t.createElement(a.dO,null))):t.createElement(s.o,null,t.createElement(a.SL,{name:"Users"}),t.createElement(j.J9,{onSubmit:le,initialValues:_,validateOnChange:!1,validationSchema:te.YM},g=>{let{errors:f,values:y,handleChange:L,isSubmitting:Z,dirty:$}=g;return t.createElement(a.l0,null,t.createElement(c.T,{primaryAction:t.createElement(r.z,{disabled:Z||!h?!0:!$,startIcon:t.createElement(U.Z,null),loading:Z,type:"submit",size:"L"},E({id:"global.save",defaultMessage:"Save"})),title:q,navigationAction:t.createElement(a.rU,{startIcon:t.createElement(A.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},E({id:"global.back",defaultMessage:"Back"}))}),t.createElement(d.D,null,K?.registrationToken&&t.createElement(u.x,{paddingBottom:6},t.createElement(ne,{registrationToken:K.registrationToken})),t.createElement(p.k,{direction:"column",alignItems:"stretch",gap:7},t.createElement(u.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(p.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(M.Z,{variant:"delta",as:"h2"},E({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})),t.createElement(D.r,{gap:5},se.map(w=>w.map(S=>t.createElement(O.P,(0,n.Z)({key:S.name},S.size),t.createElement(a.jm,(0,n.Z)({},S,{disabled:!h,error:f[S.name],onChange:L,value:y[S.name]||""})))))))),t.createElement(u.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(p.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(M.Z,{variant:"delta",as:"h2"},E({id:"global.roles",defaultMessage:"User's role"})),t.createElement(D.r,{gap:5},t.createElement(O.P,{col:6,xs:12},t.createElement(ee.Z,{disabled:!h,error:f.roles,onChange:L,value:y.roles}))))))))}))};J.propTypes={canUpdate:b().bool.isRequired};var re=J,oe=()=>{const T=(0,a.lm)(),h=(0,o.v9)(m._),E=t.useMemo(()=>({read:h.settings.users.read,update:h.settings.users.update}),[h.settings.users]),{isLoading:P,allowedActions:{canRead:W,canUpdate:R}}=(0,a.ss)(E),{state:B}=(0,i.TH)(),Q=B?.from??"/";return(0,t.useEffect)(()=>{P||!W&&!R&&T({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[P,W,R,T]),P?t.createElement(a.dO,null):!W&&!R?t.createElement(i.l_,{to:Q}):t.createElement(re,{canUpdate:R})}},76779:function(I,l,e){var t=e(32735),a=e(50563),o=e(19565),i=e(47765),m=e(60216),n=e.n(m),s=e(67879);const c=({children:r,target:d})=>{const u=(0,o.lm)(),{formatMessage:p}=(0,s.Z)(),{copy:M}=(0,o.VP)(),D=p({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),O=async()=>{await M(d)&&u({type:"info",message:{id:"notification.link-copied"}})};return t.createElement(o.Y_,{endAction:t.createElement(a.h,{label:D,noBorder:!0,icon:t.createElement(i.Z,null),onClick:O}),title:d,titleEllipsis:!0,subtitle:r,icon:t.createElement("span",{style:{fontSize:32}},"\u2709\uFE0F"),iconBackground:"neutral100"})};c.propTypes={children:n().oneOfType([n().element,n().string]).isRequired,target:n().string.isRequired},l.Z=c},16325:function(I,l,e){var t=e(32735),a=e(60216),o=e.n(a),i=e(67879),m=e(78246),n=e(76779);const s=({registrationToken:c})=>{const{formatMessage:r}=(0,i.Z)(),d=`${window.location.origin}${m.Z}auth/register?registrationToken=${c}`;return t.createElement(n.Z,{target:d},r({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};s.defaultProps={registrationToken:""},s.propTypes={registrationToken:o().string},l.Z=s},4397:function(I,l,e){var t=e(32735),a=e(68465),o=e(84967),i=e(19565),m=e(27169),n=e(60216),s=e.n(n),c=e(67879),r=e(20108),d=e(8471);const u=(0,d.F4)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,p=d.ZP.div`
  animation: ${u} 2s infinite linear;
`,M=()=>t.createElement(p,null,t.createElement(m.Z,null)),D=async()=>{const{get:U}=(0,i.tg)(),{data:A}=await U("/admin/roles");return A.data},O=({disabled:U,error:A,onChange:j,value:N})=>{const{status:x,data:Y}=(0,r.useQuery)(["roles"],D,{staleTime:5e4}),{formatMessage:C}=(0,c.Z)(),F=A?C({id:A,defaultMessage:A}):"",z=C({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),H=C({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),b=C({id:"app.components.Select.placeholder",defaultMessage:"Select"}),V=x==="loading"?t.createElement(M,null):void 0;return t.createElement(a.P,{id:"roles",disabled:U,error:F,hint:H,label:z,name:"roles",onChange:v=>{j({target:{name:"roles",value:v}})},placeholder:b,multi:!0,startIcon:V,value:N.map(v=>v.toString()),withTags:!0,required:!0},(Y||[]).map(v=>t.createElement(o.W,{key:v.id,value:v.id.toString()},C({id:`global.${v.code}`,defaultMessage:v.name}))))};O.defaultProps={disabled:!1,error:void 0},O.propTypes={disabled:s().bool,error:s().string,onChange:s().func.isRequired,value:s().array.isRequired},l.Z=O},1057:function(I,l,e){e.d(l,{YM:function(){return r},Rw:function(){return m}});var t=e(24346),a=e(19565);const o={firstname:t.Z_().trim().required(a.I0.required),lastname:t.Z_(),email:t.Z_().email(a.I0.email).lowercase().required(a.I0.required),username:t.Z_().nullable(),password:t.Z_().min(8,a.I0.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:t.Z_().min(8,a.I0.minLength).oneOf([t.iH("password"),null],"components.Input.error.password.noMatch").when("password",(d,u)=>d?u.required(a.I0.required):u)};var m={...o,currentPassword:t.Z_().when(["password","confirmPassword"],(d,u,p)=>d||u?p.required(a.I0.required):p),preferedLanguage:t.Z_().nullable()},s={roles:t.IX().min(1,a.I0.required).required(a.I0.required)},r=t.Ry().shape({...o,isActive:t.Xg(),...s})},28890:function(I,l,e){var t=e(32735),a=e(60216),o=e.n(a),i=e(67879),m=e(78246),n=e(76779);const s=({registrationToken:c})=>{const{formatMessage:r}=(0,i.Z)();return c?t.createElement(n.Z,{target:`${window.location.origin}${m.Z}auth/register?registrationToken=${c}`},r({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})):t.createElement(n.Z,{target:`${window.location.origin}${m.Z}auth/login`},r({id:"app.components.Users.MagicLink.connect.sso",defaultMessage:"Send this link to the user, the first login can be made via a SSO provider."}))};s.defaultProps={registrationToken:""},s.propTypes={registrationToken:o().string},l.Z=s},29439:function(I,l,e){e.d(l,{Z:function(){return o}});var t=e(74512);const a=i=>(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...i,children:(0,t.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),o=a}}]);
